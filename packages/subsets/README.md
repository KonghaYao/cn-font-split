# 中文 Web Font 切割工具

| 更新时间： 2023/ 6 / 16 | 江夏尧 | Version 4.0.0 |

## 简介

在工作中遇到了使用中文字体的烦恼，字体包动不动就 10 多 MB，没有办法在 Web 应用中使用，所以制作了这个字体切割的插件。通过插件将大的字体文件切割为多个小的字体文件，然后通过 CSS 文件的 `unicode-range` 按需加载，实现整个字符集的可用加载！

### 新版本功能

1. ✅ 使用 WASM 解析与分包，提升打包速度
2. ✅ 更加可控的分包方式，支持细颗粒度的字符拆分
3. ✅ 支持 OTF 格式字体打包
4. ✅ 字体预览图生成（支持 otf、ttf、woff2）
5. ✅ 优化构建分包算法，使得分包大小更加符合预期

## 一些特殊情况

1. 不支持 woff 和 eot 文件：
    1. eot 在 Web 端支持度极低，故不支持
    2. woff 类型的压缩率和普及率远不及 woff2，提供的字体源也很少使用 woff（一般有 otf 或者 ttf），故不支持
2. 强制使用分包时，源字体没有某些字形，导致一个包内没有被分满。
    1. 例如：使用一个只有大致 6373 字符的字体，但是采用 Noto-Serif-SC 分包策略，那么部分包内会有缺失字体的现象，这是正常的。
    2. 这个特性，插件将不会进行干涉。
    3. 建议较全面的字体包可以使用 Google 字体的中文分包方式，而小字体包使用自动分包策略就好了。

### 感谢

1. 项目中的 table 读取插件使用了 fonteditor-fore 的代码，神奇地完成了大量解析文本的工作，真是太棒了。
2. 项目核心插件为 Harfbuzz 项目，源项目使用 C 与 C++ 构建了一个字体布局工具，然后提供了 WASM 的打包方法。项目重新构建并提供了 Typescript 版本的 API 封装，使得代码可以更好地融入生态中。
3. wawoff2 项目将 Google 的 woff2 格式转换代码编译成为了 wasm。但是 wawoff2 项目的导出方式为 js 嵌入 wasm，极大影响了缓存，故项目也重新构建并发布出适合的版本。
